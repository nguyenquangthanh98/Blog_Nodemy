<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
<!-- Include stylesheet -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

</head>
<body>
   <!-- Create the editor container -->
<div id="editor">
    
</div>
  <div class="toolbar">

  </div>
  <button id="saveData">
      save
  </button>
</body>
<!-- Include the Quill library -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script>
var toolbarOptions = [
  ['bold', 'italic', 'underline', 'strike'],        // toggled buttons
  ['blockquote', 'code-block'],
  [{ 'header': 1 }, { 'header': 2 }],               // custom button values
  [{ 'list': 'ordered'}, { 'list': 'bullet' }],
  [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript
  [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent
  [{ 'direction': 'rtl' }],                         // text direction
  [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown
  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
  ["link","image"],
  [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
  [{ 'font': [] }],
  [{ 'align': [] }],

  ['clean']                                         // remove formatting button
];


 
var quill = new Quill('#editor', {
  modules: {
    toolbar:{
            container:  toolbarOptions,
            handlers:{
                'image': function(){
                    const input = document.createElement('input');
                    input.setAttribute('type', 'file');
                    input.setAttribute('accept', 'image/*');
                    input.click();
                    input.onchange =  function() {
                        const file = input.files[0];
                        console.log('User trying to uplaod this:', file);
                        $.ajax({
                            url:"/up",
                            data:file,
                            type:"post",
                            processData: false
                        }).done(data =>{
                            const range = this.quill.getSelection();
                    // const link = `${ROOT_URL}/file/${id}`;
                    // this part the image is inserted
                    // by 'image' option below, you just have to put src(link) of img here. 
                    // 
                    var link = data;
                        this.quill.insertEmbed(range.index, link); 
                        })
                      
                    }.bind(this); // react thing
                }
                }
    }
  },
  theme: 'snow'
});
$("#saveData").click(function(){

var delta = quill.getContents();
console.log(delta);

});
</script>
</html>